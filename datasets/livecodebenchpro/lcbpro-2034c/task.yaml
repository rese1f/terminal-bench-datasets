descriptions:
  - key: base
    description: |
      LiveCodeBench Pro (Mini) - external judge.

      The agent must create a C++17 solution file at /app/main.cpp.
      This task does not include local test cases. Instead, the test harness:
        1) POSTs the code to the external judge (/submit) to get a sid,
        2) polls GET /result/{sid}?short=1 until status == "done",
        3) passes only if the judge returns passed == true.

      Environment variables (overridable at runtime):
        - BASE_URL: judge base URL (default http://38.80.122.117:8081)
        - PID: problem id (default 2034C)
        - LANG: language (default cpp)
        - CODE_PATH: path to code (default /app/main.cpp)
        - JUDGE_TIMEOUT_SECS: poll timeout seconds (default 120)
  - key: problem
    description: |
      In the [fourth labor of Rostam](https://www.gathertales.com/story/the-tale-of-the-haft-khan-seven-labors-of-rostam/sid-604), the legendary hero from the [Shahnameh](https://en.wikipedia.org/wiki/Shahnameh), an old witch has created a magical maze to trap him. The maze is a rectangular grid consisting of $n$ rows and $m$ columns. Each cell in the maze points in a specific direction: up, down, left, or right. The witch has enchanted Rostam so that whenever he is in a cell, he will move to the next cell in the direction indicated by that cell.

      ![](https://espresso.codeforces.com/fe31b399bb2207f13616c91f5553e04c54d77805.webp)

      If Rostam eventually exits the maze, he will be freed from the witch's enchantment and will defeat her. However, if he remains trapped within the maze forever, he will never escape.

      The witch has not yet determined the directions for all the cells. She wants to assign directions to the unspecified cells in such a way that the number of starting cells from which Rostam will be trapped forever is maximized. Your task is to find the maximum number of starting cells which make Rostam trapped.

      ### Input

      The first line of the input contains an integer $t$ ($1 \leq t \leq 10^4$), the number of test cases.

      For each test case:

      - The first line contains two integers $n$ and $m$ ($1 \leq n, m \leq 1000$), representing the number of rows and columns in the maze.
      - Each of the next $n$ lines contains a string of $m$ characters representing the directions in the maze. Each character is one of the following:
      - U (up)
      - D (down)
      - L (left)
      - R (right)
      - ? (unspecified direction)

      It's guaranteed that the sum of $n \cdot m$ over all test cases is at most $10^6$.

      ### Output

      For each test case, print a single integer, the maximum number of starting cells from which Rostam will be trapped forever after assigning directions to the unspecified cells optimally.

      ### Example

      #### Input #1

      ```

      3

      3 3

      UUU

      L?R

      DDD

      2 3

      ???

      ???

      3 3

      ?U?

      R?L

      RDL

      ```

      #### Output #1

      ```
      0
      6
      5
      ```

      ### Note

      In the first test case, all of the cells will be good no matter what you do.

      In the second test case, if you assign the ?s like the picture below, all of the cells will be bad:

      ![](https://espresso.codeforces.com/c667fb00a6b0c8bcc1f533cb121685a1542afcf7.png)

      In the third test case, if you assign the ?s like the picture below, you will have $5$ bad cells (red-shaded cells):

      ![](https://espresso.codeforces.com/f2e2c3b844c4b7a8643622146bdf82e54c8ec8e3.png)

instruction: base
author_email: shz060@ucsd.edu
author: LiveCodeBench Pro Team
difficulty: easy
tags: []
max_agent_timeout_sec: 300
max_test_timeout_sec: 180